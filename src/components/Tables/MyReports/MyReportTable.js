/* eslint-disable no-lone-blocks */
import React, { useState } from 'react'
import { Table, TableBody, TableCell, TableContainer, TableHead, TableRow, Paper, Typography, Grid, TablePagination, TableFooter } from '@material-ui/core';
import { makeStyles } from '@material-ui/core/styles';
import { FaEdit } from 'react-icons/fa';
import Axios from 'axios'
import Notification from '../../Dialog/Notification';
import ConfirmDialog from '../../Dialog/ConfirmDialog';
import ViewEditDialog from '../../Dialog/ViewEditDialog';
import SuccessDialog from '../../Dialog/SuccessDialog';
import LoginAuthPop from '../../Dialog/LoginAuthPop';
import SuccessRegisterDialog from '../../Dialog/SuccessRegisterDialog';
import PopUp from '../../Dialog/PopUp'
import Moment from 'react-moment';
import { Container, BoxUpload, ImagePreview } from "../../../components/Styled/ImageStyle";

const useStyles = makeStyles((theme) => ({ table: { minWidth: 200, }, tableContainer: { maxWidth: 1175, borderRadius: 0, border: "0.5px solid #d5dbd9" }, tableHeaderCell: { fontWeight: 'bold', backgroundColor: '#0061a8', color: theme.palette.getContrastText(theme.palette.primary.dark), fontFamily: "Montserrat, sans-serif", cursor: "pointer", lineHeight: "1.43", paddingTop: "15px", paddingBottom: "15px" }, tableCell: { fontFamily: "Montserrat, sans-serif", cursor: "pointer", }, avatar: { backgroundColor: theme.palette.primary.light, color: theme.palette.getContrastText(theme.palette.primary.light) }, name: { cursor: "pointer", fontWeight: 'bold', color: "#2e4a56", fontFamily: "Montserrat, sans-serif" }, residentIdTitle: { fontSize: "15px" }, status: { fontWeight: 'bold', fontSize: '0.75rem', color: 'white', backgroundColor: 'grey', borderRadius: 5, padding: '3px 10px', display: 'inline-block', fontFamily: "Montserrat, sans-serif", }, tablePagination: { overflow: "hidden" } }))
export default function MyReportTable({ data }) {
    Axios.defaults.withCredentials = true;
    const [confirmDialog, setConfirmDialog] = useState({ isOpen: !1, title: "", subtitle: "", yesButton: "", noButton: "" }), [successRegisterDialog, setSuccessRegisterDialog] = useState({ isOpen: !1, title: "", subtitle: "", yesButton: "", noButton: "" }), [notify, setNotify] = useState({ isOpen: !1, message: "", type: "" }), [viewEditDialog, setViewEditDialog] = useState({ isOpen: !1, title: "", subtitle: "", yesButton: "", noButton: "" }), [errorDialog, setErrorDialog] = useState({ isOpen: !1, title: "", subtitle: "", noButton: "" }), [successDialog, setSuccessDialog] = useState({ isOpen: !1, title: "", subtitle: "", yesButton: "", noButton: "" }), classes = useStyles(), [openPopup, setOpenPopup] = useState(!1), [report_id, setReportId] = useState(""), [incident_location, setIncidentLocation] = useState(""), [incident_date, setIncidentDate] = useState(""), [incident_time, setIncidentTime] = useState(""), [incident_desc, setIncidentDescription] = useState(""), [date_submitted, setDateSubmitted] = useState(""), [fire_brigade, setFireBrigadeAttended] = useState(""), [page, setPage] = useState(0), [rowsPerPage, setRowsPerPage] = useState(5), handleChangePage = (e, t) => { setPage(t) }, handleChangeRowsPerPage = e => { setRowsPerPage(+e.target.value); setPage(0) }, [img, setImg] = useState(""), postImage = "";
    function openInPopup(report_id, incident_location, incident_date, incident_time, incident_description, date_submitted, fire_brigade_attended, report_img_vid) { setOpenPopup(true); if (report_id === 1) { setReportId("Fire Incident Report"); } else if (report_id === 2) { setReportId("Emergency Report"); } else if (report_id === 3) { setReportId("Accident Report"); } else if (report_id === 4) { setReportId("Incident Report"); } setIncidentLocation(incident_location); setIncidentDate(incident_date); setIncidentTime(incident_time); setIncidentDescription(incident_description); setDateSubmitted(date_submitted); setFireBrigadeAttended(fire_brigade_attended); setImg(report_img_vid) }
    return (
        <div>
            <SuccessDialog successDialog={successDialog} setSuccessDialog={setSuccessDialog} />
            <SuccessRegisterDialog successRegisterDialog={successRegisterDialog} setSuccessRegisterDialog={setSuccessRegisterDialog} />
            <Notification notify={notify} setNotify={setNotify} />
            <ConfirmDialog confirmDialog={confirmDialog} setConfirmDialog={setConfirmDialog} />
            <ViewEditDialog viewEditDialog={viewEditDialog} setViewEditDialog={setViewEditDialog} />
            <LoginAuthPop errorDialog={errorDialog} setErrorDialog={setErrorDialog} />
            <PopUp title="My Reports" openPopup={openPopup} setOpenPopup={setOpenPopup}> <div className="generate-certificate-body"> <div className="generate-certificate-container"> <div className="wrapper" id="wrapper_profile">{report_id === "Fire Incident Report" ? <> <div className="forms"> <div className="input_fields"> <label>Date of Fire Incident</label> <p className="inputs"><Moment format={"MMMM DD, YYYY"} date={incident_date} /></p></div><div className="input_fields"> <label>Time of Fire Incident</label> <input type="text" className="inputs" disabled defaultValue={incident_time} /> </div><div className="input_fields"> <label>Fire Incident Location</label> <textarea type="text" className="textarea" disabled defaultValue={incident_location} /> </div><div className="input_fields"> <label>Fire Incident Details</label> <textarea type="text" className="textarea" disabled defaultValue={incident_desc} /> </div><div className="input_fields"> <label>Did Fire Brigade Attend?</label> <textarea className="textarea" disabled defaultValue={fire_brigade}></textarea> </div><div className="input_fields"> <label>Date Submitted</label> <p className="inputs"><Moment format={"MMMM DD, YYYY"} date={date_submitted} /></p></div> <div className="input_fields"><label>Photo: </label><Container> <BoxUpload> <div className="image-upload"> <ImagePreview>{img != null ? (<img id="uploaded-image" src={`data:image/jpeg;base64,${Buffer.from(img)}`} draggable={false} alt="uploaded-img" className="img_content" />) : (<img id="uploaded-image" src={`data:image/jpeg;base64,${Buffer.from(postImage)}`} draggable={false} alt="uploaded-img" />)}</ImagePreview> </div></BoxUpload> </Container></div></div></> : ""}{report_id === "Emergency Report" ? <> <div className="forms"> <div className="input_fields"> <label>Location of Emergency</label> <textarea type="text" className="textarea" disabled defaultValue={incident_location} /> </div><div className="input_fields"> <label>Emergency Description</label> <textarea type="text" className="textarea" disabled defaultValue={incident_desc} /> </div><div className="input_fields"> <label>Date Submitted</label> <p className="inputs"><Moment format={"MMMM DD, YYYY"} date={date_submitted} /></p></div><div className="input_fields"><label>Photo: </label><Container> <BoxUpload> <div className="image-upload"> <ImagePreview>{img != null ? (<img id="uploaded-image" src={`data:image/jpeg;base64,${Buffer.from(img)}`} draggable={false} alt="uploaded-img" className="img_content" />) : (<img id="uploaded-image" src={`data:image/jpeg;base64,${Buffer.from(postImage)}`} draggable={false} alt="uploaded-img" />)}</ImagePreview> </div></BoxUpload> </Container></div></div></> : ""}{report_id === "Accident Report" ? <> <div className="forms"> <div className="input_fields"> <label>Date of Accident</label> <p className="inputs"><Moment format={"MMMM DD, YYYY"} date={incident_date} /></p></div><div className="input_fields"> <label>Time of Accident</label> <input type="text" className="inputs" disabled defaultValue={incident_time} /> </div><div className="input_fields"> <label>Exact Location of Accident</label> <textarea type="text" className="textarea" disabled defaultValue={incident_location} /> </div><div className="input_fields"> <label>Accident Description</label> <textarea type="text" className="textarea" disabled defaultValue={incident_desc} /> </div><div className="input_fields"> <label>Date Submitted</label> <p className="inputs"><Moment format={"MMMM DD, YYYY"} date={date_submitted} /></p></div><div className="input_fields"><label>Photo: </label><Container> <BoxUpload> <div className="image-upload"> <ImagePreview>{img != null ? (<img id="uploaded-image" src={`data:image/jpeg;base64,${Buffer.from(img)}`} draggable={false} alt="uploaded-img" className="img_content" />) : (<img id="uploaded-image" src={`data:image/jpeg;base64,${Buffer.from(postImage)}`} draggable={false} alt="uploaded-img" />)}</ImagePreview> </div></BoxUpload> </Container></div></div></> : ""}{report_id === "Incident Report" ? <> <div className="forms"> <div className="input_fields"> <label>Date of Incident</label> <p className="inputs"><Moment format={"MMMM DD, YYYY"} date={incident_date} /></p></div><div className="input_fields"> <label>Time of Incident</label> <input type="text" className="inputs" disabled defaultValue={incident_time} /> </div><div className="input_fields"> <label>Location of Incident</label> <textarea type="text" className="textarea" disabled defaultValue={incident_location} /> </div><div className="input_fields"> <label>Incident Description</label> <textarea type="text" className="textarea" disabled defaultValue={incident_desc} /> </div><div className="input_fields"> <label>Date Submitted</label> <p className="inputs"><Moment format={"MMMM DD, YYYY"} date={date_submitted} /></p></div><div className="input_fields"><label>Photo: </label><Container> <BoxUpload> <div className="image-upload"> <ImagePreview>{img != null ? (<img id="uploaded-image" src={`data:image/jpeg;base64,${Buffer.from(img)}`} draggable={false} alt="uploaded-img" className="img_content" />) : (<img id="uploaded-image" src={`data:image/jpeg;base64,${Buffer.from(postImage)}`} draggable={false} alt="uploaded-img" />)}</ImagePreview> </div></BoxUpload> </Container></div></div></> : ""}</div></div></div></PopUp>
            <TableContainer component={Paper} className={classes.tableContainer}> <Table className={classes.table} aria-label="simple table"> <TableHead > <TableRow className={classes.tableRow}> <TableCell className={classes.tableHeaderCell}>Report Type</TableCell> <TableCell className={classes.tableHeaderCell}>Date Submitted</TableCell> <TableCell className={classes.tableHeaderCell} id="mobile_hidden">Action</TableCell> </TableRow> </TableHead> <TableBody>{data.map((row) => { return (<TableRow> <TableCell className={classes.tableCell} onClick={() => openInPopup(row.report_id, row.incident_location, row.incident_date, row.incident_time, row.incident_description, row.date_submitted, row.fire_brigade_attended, row.report_img_vid)}> <Grid container> <Grid item lg={10}> <Typography className={classes.name}>{row.report_id === 4 ? "Incident Report" : ""}{row.report_id === 3 ? "Accident Report" : ""}{row.report_id === 2 ? "Emergency Report" : ""}{row.report_id === 1 ? "Fire Incident Report" : ""}</Typography> </Grid> </Grid> </TableCell> <TableCell className={classes.tableCell}> <p className="inputs"><Moment format={"MMMM DD, YYYY"} date={row.date_submitted} /></p></TableCell> <TableCell id="mobile_hidden"> <button className="view_edit" onClick={() => openInPopup(row.report_id, row.incident_location, row.incident_date, row.incident_time, row.incident_description, row.date_submitted, row.fire_brigade_attended, row.report_img_vid)}><FaEdit /></button> </TableCell> </TableRow>) })}</TableBody> <TableFooter> <TablePagination className={classes.tablePagination} rowsPerPageOptions={[5, 10, 15]} component="span" count={data.length} rowsPerPage={rowsPerPage} page={page} onPageChange={handleChangePage} onRowsPerPageChange={handleChangeRowsPerPage} /> </TableFooter> </Table> </TableContainer>
        </div >
    )
}